# Benign vs. Malware EDA

How many benign apk I have ingested, processed




    2747



How many malware apk I have processed




    2030



Before we do our EDA, lets see the size of each csv features, (in MB)




    (2747,)






    (2030,)



The Stats of benign feature file of benign and malware




    count    2747.000000
    mean       13.032417
    std        12.185762
    min         0.000685
    25%         5.733237
    50%        11.156393
    75%        17.386611
    max       342.888342
    dtype: float64






    count    2030.000000
    mean        1.359864
    std         2.170633
    min         0.011738
    25%         0.085016
    50%         0.285466
    75%         1.888253
    max        25.360481
    dtype: float64



- We notice that most of the malware apps are less than 2 MB, and the most of benign apps are less than 20 MB, which makes significantly different in app size and computation complexity. So we want to design a ML model down cast to small apps
- Specifically, we will add a constraint to app size, 3 MB

- The Stats of downcasted apps




    count    405.000000
    mean       1.060372
    std        0.849133
    min        0.000685
    25%        0.312517
    50%        0.838329
    75%        1.733680
    max        2.976587
    dtype: float64






    count    1721.000000
    mean        0.622749
    std         0.827421
    min         0.011738
    25%         0.082823
    50%         0.160114
    75%         0.874394
    max         2.993118
    dtype: float64



we will make the classification balanced, so we sample the same amount malwares




    count    405.000000
    mean       0.531803
    std        0.758693
    min        0.016807
    25%        0.076918
    50%        0.110209
    75%        0.690264
    max        2.993118
    dtype: float64






    18bcefdd591205ddedf3382f5fd22a05.csv    1.404254
    457421a21f539881d78497b9e8b53584.csv    0.057405
    fb740d902a18519d46e15dedf6d135a1.csv    0.085115
    2a96efaab45addbeab73abb96ee91034.csv    0.019603
    0b6c95bfce7086d6e707c481d4de99f2.csv    0.204378
                                              ...   
    1c54e569ea432df901853f34723485bc.csv    0.097392
    0811a208c0c87aa8e3af6b714921f155.csv    0.080320
    cacfee038d26131a8568b3c11ee7f840.csv    0.541179
    b83df8e33875745aaf2459dcc9f302b2.csv    0.080189
    40285e00b0e9204bd25cb7dd34d1c2c9.csv    0.060081
    Length: 405, dtype: float64






<table style="border: 2px solid white;">
<tr>
<td style="vertical-align: top; border: 0px solid white">
<h3 style="text-align: left;">Client</h3>
<ul style="text-align: left; list-style: none; margin: 0; padding: 0;">
  <li><b>Scheduler: </b>tcp://127.0.0.1:46685</li>
  <li><b>Dashboard: </b><a href='http://127.0.0.1:8787/status' target='_blank'>http://127.0.0.1:8787/status</a>
</ul>
</td>
<td style="vertical-align: top; border: 0px solid white">
<h3 style="text-align: left;">Cluster</h3>
<ul style="text-align: left; list-style:none; margin: 0; padding: 0;">
  <li><b>Workers: </b>8</li>
  <li><b>Cores: </b>8</li>
  <li><b>Memory: </b>68.72 GB</li>
</ul>
</td>
</tr>
</table>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>api</th>
      <th>invocation</th>
      <th>block</th>
      <th>app</th>
      <th>malware</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ljava/lang/Object;-&gt;&lt;init&gt;</td>
      <td>invoke-direct</td>
      <td>constructor &lt;init&gt;(Lair/com/galactig/revision2...</td>
      <td>adolygu-revision</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lair/com/galactig/revision2017/AppEntry;-&gt;acce...</td>
      <td>invoke-static</td>
      <td>public onClick(Landroid/content/DialogInterfac...</td>
      <td>adolygu-revision</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lair/com/galactig/revision2017/AppEntry;-&gt;acce...</td>
      <td>invoke-static</td>
      <td>public onClick(Landroid/content/DialogInterfac...</td>
      <td>adolygu-revision</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Lair/com/galactig/revision2017/AppEntry;-&gt;acce...</td>
      <td>invoke-static</td>
      <td>public onClick(Landroid/content/DialogInterfac...</td>
      <td>adolygu-revision</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Lcom/adobe/air/InstallOfferPingUtils;-&gt;PingAnd...</td>
      <td>invoke-static</td>
      <td>public onClick(Landroid/content/DialogInterfac...</td>
      <td>adolygu-revision</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>api</th>
      <th>invocation</th>
      <th>block</th>
      <th>app</th>
      <th>malware</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ljava/lang/Object;-&gt;&lt;init&gt;</td>
      <td>invoke-direct</td>
      <td>constructor &lt;init&gt;(Lcom/radioadv/AddEditContac...</td>
      <td>18bcefdd591205ddedf3382f5fd22a05</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lcom/radioadv/AddEditContacts;-&gt;access$0</td>
      <td>invoke-static</td>
      <td>public onClick(Landroid/view/View;)VAddEditCon...</td>
      <td>18bcefdd591205ddedf3382f5fd22a05</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lcom/radioadv/AddEditContacts;-&gt;access$1</td>
      <td>invoke-static</td>
      <td>public onClick(Landroid/view/View;)VAddEditCon...</td>
      <td>18bcefdd591205ddedf3382f5fd22a05</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ljava/lang/Object;-&gt;&lt;init&gt;</td>
      <td>invoke-direct</td>
      <td>constructor &lt;init&gt;(Lcom/radioadv/AddEditContac...</td>
      <td>18bcefdd591205ddedf3382f5fd22a05</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Lcom/radioadv/AddEditContacts;-&gt;access$0</td>
      <td>invoke-static</td>
      <td>public onClick(Landroid/view/View;)VAddEditCon...</td>
      <td>18bcefdd591205ddedf3382f5fd22a05</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>


## API Calls

### how many rows benign apps have




    2748728



### how many rows malware apps have




    1377097



### how many benign sample we collected




    405



### how many malware samples we collected




    405



### TOP 20 normalized API call comparison 


![png](EDA_Malware%26Benign_files/EDA_Malware%26Benign_41_0.png)



![png](EDA_Malware%26Benign_files/EDA_Malware%26Benign_41_1.png)


### TOP 100 api calls (percentage in common)




    0.01



### Observation
Following finding from eda above:
  - In general, Benign apps are much more complicated than malware apps in structures. we collected 405 benign apps and 405 malware apps, but there are 2748728 rows of infomation for benign apps and 1377097 rows of information for malware apps.
  - As plot shown above, the proportion (distribution) of Malware and Benign's api calls are relatively same.
  - The most common api calls are significantly different. For top 100 api calls of benign apps and malware apps, there are nearly no common api calls.

## Number of abnormal Apis

to find the cut between normal api and abnormal api

Stats of benign distinct api counts




    count    216500.000000
    mean         12.696194
    std         326.005224
    min           1.000000
    25%           1.000000
    50%           2.000000
    75%           4.000000
    max       98202.000000
    dtype: float64



Stats of malware distinct api counts




    count    93928.000000
    mean        14.645984
    std        254.692561
    min          1.000000
    25%          1.000000
    50%          2.000000
    75%          5.000000
    max      48812.000000
    dtype: float64



Number of abnormal api in benign apps




    172756



Number of abnormal api in malware apps




    70554



We noticed taht the there are much more abnormal APIS used in benign apps. We may filter out the abnormal api in model afterwards

## Block

How many blocks the benign apps have




    259999



How many blocks the malware apps have




    99840



Stats of how many api calls each block has for benign apps




    count    259999.000000
    mean         10.572071
    std          48.680578
    min           1.000000
    25%           1.000000
    50%           3.000000
    75%           7.000000
    max        4624.000000
    Name: block, dtype: float64






    count    99840.000000
    mean        13.793039
    std         42.077762
    min          1.000000
    25%          1.000000
    50%          4.000000
    75%         12.000000
    max       1817.000000
    Name: block, dtype: float64



## Package

stats of number of package used of benign apps




    count     52161.000000
    mean         52.696957
    std        1137.859921
    min           1.000000
    25%           1.000000
    50%           3.000000
    75%          12.000000
    max      175178.000000
    Name: api, dtype: float64



stats of number of package used of malware apps




    count    20552.000000
    mean        66.935967
    std        948.045867
    min          1.000000
    25%          1.000000
    50%          4.000000
    75%         20.000000
    max      92270.000000
    Name: api, dtype: float64



The malwares are likely to use more same packages than benign apps did. So number of package used will be usefull.

## invocation


![png](EDA_Malware%26Benign_files/EDA_Malware%26Benign_78_0.png)



![png](EDA_Malware%26Benign_files/EDA_Malware%26Benign_78_1.png)

